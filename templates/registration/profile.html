{% extends 'base.html' %}
{% load static %}

{% block title %}User Profile{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="bg-white rounded-lg shadow-md overflow-hidden">
        <div class="p-6 border-b border-gray-200">
            <h1 class="text-2xl font-bold text-gray-800">Account Settings</h1>
            <p class="mt-1 text-sm text-gray-600">Manage your profile, security, and account settings.</p>
        </div>

        <div>
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8 px-6" aria-label="Tabs">
                    <button id="tab-profile" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-green-600 border-green-500">
                        Profile
                    </button>
                    <button id="tab-security" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        Security
                    </button>
                    <button id="tab-account" class="tab-button whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                        Account Type
                    </button>
                </nav>
            </div>

            <div class="p-6">
                <div id="content-profile" class="tab-content">
                    {% include 'registration/profile_tab.html' %}
                </div>
                <div id="content-security" class="tab-content hidden">
                    {% include 'registration/security_tab.html' %}
                </div>
                <div id="content-account" class="tab-content hidden">
                    {% include 'registration/account_type_tab.html' %}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const tabs = document.querySelectorAll('.tab-button');
    const tabContents = document.querySelectorAll('.tab-content');

    function switchTab(tabId) {
        tabs.forEach(tab => {
            const isSelected = tab.id === `tab-${tabId}`;
            tab.classList.toggle('text-green-600', isSelected);
            tab.classList.toggle('border-green-500', isSelected);
            tab.classList.toggle('text-gray-500', !isSelected);
            tab.classList.toggle('hover:text-gray-700', !isSelected);
            tab.classList.toggle('hover:border-gray-300', !isSelected);
        });

        tabContents.forEach(content => {
            content.classList.toggle('hidden', content.id !== `content-${tabId}`);
        });
    }

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            const tabId = tab.id.split('-')[1];
            switchTab(tabId);
            // Update URL without reloading
            const url = new URL(window.location);
            url.searchParams.set('tab', tabId);
            window.history.pushState({}, '', url);
        });
    });

    // On page load, check for a tab parameter in the URL
    const urlParams = new URLSearchParams(window.location.search);
    const tabQuery = urlParams.get('tab');

    if (tabQuery) {
        switchTab(tabQuery);
    }
});
</script>
{% endblock %}